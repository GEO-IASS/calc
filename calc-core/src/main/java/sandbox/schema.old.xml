<Schema name="Naforma1">
  <Dimension type="StandardDimension" visible="true" highCardinality="false" name="AOI">
<!--     <Hierarchy name="AOI" visible="true" hasAll="false" primaryKey="id" primaryKeyTable="region"> -->
   <Hierarchy name="AOI" visible="true" hasAll="false">
        <View alias="admin_unit">
        <SQL dialect="generic"><![CDATA[
          select
              naforma1.country.id    as country_id,
              naforma1.country.label as country_label,
              naforma1.region.id     as region_id,
              naforma1.region.label  as region_label,
              naforma1.district.id     as district_id,
              naforma1.district.label  as district_label
          from
          	  naforma1.district
          inner join
              naforma1.region
          on
              (
                  naforma1.district.parent_id = naforma1.region.id)
          inner join
              naforma1.country
          on
              (
                  naforma1.region.parent_id = naforma1.country.id)
          ]]>
        </SQL>
      </View>
      <Level name="Country" visible="true" column="country_id" nameColumn="country_label" uniqueMembers="true" levelType="Regular" hideMemberIf="Never">
      </Level>
      <Level name="Region" visible="true" column="region_id" nameColumn="region_label" uniqueMembers="true" levelType="Regular" hideMemberIf="Never">
      </Level>
      <Level name="District" visible="true" column="district_id" nameColumn="district_label" uniqueMembers="true" levelType="Regular" hideMemberIf="Never">
      </Level>
    
<!--       <Join leftKey="parent_id" rightKey="id">-->
<!--        <Table name="district" schema="naforma1">-->
<!--        </Table>-->
<!--         <Join leftKey="parent_id" rightKey="id" leftAlias="region" rightAlias="country"> -->
<!--           <Table name="region" schema="naforma1"> -->
<!--           </Table> -->
<!--           <Table name="country" schema="naforma1"> -->
<!--           </Table> -->
<!--         </Join> -->
<!--      </Join>-->
<!--       <Level name="Country" visible="true" table="country" column="id" nameColumn="label" uniqueMembers="true" levelType="Regular" hideMemberIf="Never"> -->
<!--       </Level> -->
<!--       <Level name="Region" visible="true" table="region" column="id" nameColumn="label" uniqueMembers="true" levelType="Regular" hideMemberIf="Never"> -->
<!--       </Level> -->
      <!--<Level name="District" visible="true" table="district" column="id" nameColumn="label" uniqueMembers="true" levelType="Regular" hideMemberIf="Never">
      </Level>-->
    </Hierarchy>
  </Dimension>
  <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Accessibility">
    <Hierarchy name="Accessibility" visible="true" hasAll="true">
      <Table name="accessibility" schema="naforma1">
      </Table>
      <Level name="Accessibility" visible="true" table="accessibility" column="id" nameColumn="label" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never">
      </Level>
    </Hierarchy>
  </Dimension>
  <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Land Use">
    <Hierarchy name="Land Use" visible="true" hasAll="true">
      <Table name="land_use" schema="naforma1">
      </Table>
      <Level name="Land Use" visible="true" table="land_use" column="id" nameColumn="label" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never">
      </Level>
    </Hierarchy>
  </Dimension>
  <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Vegetation Type">
    <Hierarchy name="Vegetation Type" visible="true" hasAll="true">
      <Table name="vegetation_type" schema="naforma1">
      </Table>
      <Level name="Vegetation Type" visible="true" table="vegetation_type" column="id" nameColumn="label" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never">
      </Level>
    </Hierarchy>
  </Dimension>
  <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Catchment">
    <Hierarchy name="Catchment" visible="true" hasAll="true">
      <Table name="catchment" schema="naforma1">
      </Table>
      <Level name="Catchment" visible="true" table="catchment" column="id" nameColumn="label" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never">
      </Level>
    </Hierarchy>
  </Dimension>
  <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Erosion">
    <Hierarchy name="Erosion" visible="true" hasAll="true">
      <Table name="erosion" schema="naforma1">
      </Table>
      <Level name="Erosion" visible="true" table="erosion" column="id" nameColumn="label" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never">
      </Level>
    </Hierarchy>
  </Dimension>
  <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Grazing">
    <Hierarchy name="Grazing" visible="true" hasAll="true">
      <Table name="grazing" schema="naforma1">
      </Table>
      <Level name="Grazing" visible="true" table="grazing" column="id" nameColumn="label" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never">
      </Level>
    </Hierarchy>
  </Dimension>
  <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Mgmt Proposal">
    <Hierarchy name="Mgmt Proposal" visible="true" hasAll="true">
      <Table name="mgmt_proposal" schema="naforma1">
      </Table>
      <Level name="Mgmt Proposal" visible="true" table="mgmt_proposal" column="id" nameColumn="label" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never">
      </Level>
    </Hierarchy>
  </Dimension>
  <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Nwfp">
    <Hierarchy name="Nwfp" visible="true" hasAll="true">
      <Table name="nwfp" schema="naforma1">
      </Table>
      <Level name="Nwfp" visible="true" table="nwfp" column="id" nameColumn="label" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never">
      </Level>
    </Hierarchy>
  </Dimension>
  <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Ownership Type">
    <Hierarchy name="Ownership Type" visible="true" hasAll="true">
      <Table name="ownership_type" schema="naforma1">
      </Table>
      <Level name="Ownership Type" visible="true" table="ownership_type" column="label" nameColumn="label" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never">
      </Level>
    </Hierarchy>
  </Dimension>
  <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Shrubs Coverage">
    <Hierarchy name="Shrubs Coverage" visible="true" hasAll="true">
      <Table name="shrubs_coverage" schema="naforma1">
      </Table>
      <Level name="Shrubs Coverage" visible="true" table="shrubs_coverage" column="id" nameColumn="label" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never">
      </Level>
    </Hierarchy>
  </Dimension>
  <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Soil Structure">
    <Hierarchy name="Soil Structure" visible="true" hasAll="true">
      <Table name="soil_structure" schema="naforma1">
      </Table>
      <Level name="Soil Structure" visible="true" table="soil_structure" column="id" nameColumn="label" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never">
      </Level>
    </Hierarchy>
  </Dimension>
  <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Soil Texture">
    <Hierarchy name="Soil Texture" visible="true" hasAll="true">
      <Table name="soil_texture" schema="naforma1">
      </Table>
      <Level name="Soil Texture" visible="true" table="soil_texture" column="id" nameColumn="label" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never">
      </Level>
    </Hierarchy>
  </Dimension>
  <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Undergrowth Type">
    <Hierarchy name="Undergrowth Type" visible="true" hasAll="true">
      <Table name="undergrowth_type" schema="naforma1">
      </Table>
      <Level name="Undergrowth Type" visible="true" table="undergrowth_type" column="id" nameColumn="label" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never">
      </Level>
    </Hierarchy>
  </Dimension>
  <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Species">
    <Hierarchy name="Species" visible="true" hasAll="true">
      <Table name="taxon" schema="calc">
      </Table>
      <Level name="Species" visible="true" table="taxon" column="taxon_id" nameColumn="scientific_name" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never">
      </Level>
    </Hierarchy>
  </Dimension>
  <Dimension type="StandardDimension" visible="true" highCardinality="false" name="Stratum">
    <Hierarchy name="Stratum" visible="true" hasAll="true">
      <Table name="stratum" schema="calc">
      </Table>
      <Level name="Stratum" visible="true" table="stratum" column="stratum_id" nameColumn="stratum_no" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never">
      </Level>
    </Hierarchy>
  </Dimension>
  <Cube name="Plot" visible="true" cache="false" enabled="true">
    <Table name="plot_fact" schema="naforma1">
      <AggName name="agg_district_stratum_plot_fact">
        <AggFactCount column="cnt">
        </AggFactCount>
        <AggForeignKey aggColumn="stratum_id" factColumn="stratum_id"/>
        <AggMeasure column="est_area" name="[Measures].[Area]">
        </AggMeasure>
        <AggMeasure column="cnt1" name="[Measures].[Count]">
        </AggMeasure>
        <AggLevel column="country" name="[AOI].[Country]">
        </AggLevel>
        <AggLevel column="region" name="[AOI].[Region]">
        </AggLevel>
        <AggLevel column="district" name="[AOI].[District]">
        </AggLevel>
        <!--
       
        <AggForeignKey aggColumn="vegetation_type" factColumn="vegetation_type"/>
        <AggForeignKey aggColumn="land_use" factColumn="land_use"/>
        <AggMeasure column="est_area" name="[Measures].[Area]">
        </AggMeasure>
        <AggMeasure column="cnt" name="[Measures].[Count]">
        </AggMeasure>
        <AggLevel column="stratum_id" name="[Stratum.Stratum].[Stratum]">
        </AggLevel>
        <AggLevel column="land_use" name="[Land Use.Land Use].[Land Use]">
        </AggLevel>
        <AggLevel column="vegetation_type" name="[Vegetation Type.Vegetation Type].[Vegetation Type]">
        </AggLevel>-->
      </AggName>
      <!--<AggName name="agg_region_stratum_plot_fact" ignorecase="true">
        <AggFactCount column="cnt">
        </AggFactCount>
        <AggMeasure column="est_area" name="[Measures].[Area]">
        </AggMeasure>
        <AggLevel column="region" name="[AOI.AOI].[Region]">
        </AggLevel>
        <AggLevel column="stratum_id" name="[Stratum.Stratum].[Stratum]">
        </AggLevel>
        <AggLevel column="land_use" name="[Land Use.Land Use].[Land Use]">
        </AggLevel>
        <AggLevel column="vegetation_type" name="[Vegetation Type.Vegetation Type].[Vegetation Type]">
        </AggLevel>
      </AggName>-->
     <!-- <AggName name="agg_country_stratum_plot_fact" ignorecase="true">
        <AggFactCount column="cnt">
        </AggFactCount>
        <AggMeasure column="est_area" name="[Measures].[Area]">
        </AggMeasure>
        <AggLevel column="country" name="[AOI.AOI].[Country]">
        </AggLevel>
        <AggLevel column="stratum_id" name="[Stratum.Stratum].[Stratum]">
        </AggLevel>
        <AggLevel column="land_use" name="[Land Use.Land Use].[Land Use]">
        </AggLevel>
        <AggLevel column="vegetation_type" name="[Vegetation Type.Vegetation Type].[Vegetation Type]">
        </AggLevel>
      </AggName>-->
    </Table>
    <Dimension name="Plot Section">
      <Hierarchy hasAll="true">
        <Level name="Plot Section" column="plot_section_id" uniqueMembers="true"/>
      </Hierarchy>
    </Dimension>
    <DimensionUsage source="Land Use" name="Land Use" visible="true" foreignKey="land_use" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Vegetation Type" name="Vegetation Type" visible="true" foreignKey="vegetation_type" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="Stratum" name="Stratum" visible="true" foreignKey="stratum_id" highCardinality="false">
    </DimensionUsage>
    <DimensionUsage source="AOI" name="AOI" visible="true" foreignKey="district" highCardinality="false">
    </DimensionUsage>
    <Measure name="Area" column="est_area" formatString="#,###" aggregator="sum" caption="Area" description="Estimated Area" visible="true">
    </Measure>
    <Measure name="Count" column="cnt" datatype="Numeric" formatString="#,###" aggregator="sum" visible="true">
    </Measure>
  </Cube>
  <Role name="ROLE_ADMIN">
    <SchemaGrant access="all">
    </SchemaGrant>
  </Role>
  <Role name="ROLE_USER">
    <SchemaGrant access="all">
    </SchemaGrant>
  </Role>
</Schema>
