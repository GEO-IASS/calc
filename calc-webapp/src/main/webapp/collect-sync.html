<div class="page-section" style="padding-top:40px;">
	<div class="row" id="sync-form-section">
		<div class="col-md-12 text-center">
			<form  method="post" enctype="multipart/form-data" action="rest/collect/data.json">
				<button type="button" class="btn btn-default btn-lg" name="upload-btn">Start to upload Collect backup file</button>
			    <input type="file" name="file" style="display:none" />		    		    
			</form>	
		</div>
	</div>
	<div class="row" id="sync-progress-section">
		<div class="col-md-11">
			<div class="progress progress-striped active">
	        	<div class="progress-bar progress-bar-info"></div>
	        </div>	        
	    </div>
	    <div class="col-md-1">
	    	<div class="percent">0%</div>
	    </div>
	</div>
	
	<script>
$(function(){
	
	var $formSection = $('#sync-form-section');
	var $form = $formSection.find("form");
	var $uploadBtn = $form.find("button[name='upload-btn']"); 
	var $file = $form.find("input[name='file']");
	
	var $progressSection = $("#sync-progress-section");
	var $progressBar = $progressSection.find(".progress-bar");
	var $progressPercent = $progressSection.find(".percent");
	
	$progressSection.hide();
	
	var resetForm = function() {
		$progressSection.hide();
		$formSection.show();
		
		$progressPercent.html("0%");
		$progressBar.width(0);
	};
	
	
	$form.ajaxForm( {
	    dataType : 'json',
	    beforeSubmit: function() {
	        $(this).addClass('loading');
	        
	        $formSection.hide();
			$progressSection.show();
	    },
	    uploadProgress: function ( event, position, total, percentComplete ) {
	    	var percentVal = percentComplete+'%';
	    	
	    	$progressBar.width(percentVal);
	    	$progressPercent.html(percentVal);
	    },
	    success: function ( json ) {
			$progressSection.hide();
	    	$formSection.show();
			
	    	checkJobStatus(function() {
	    		CalculationStepManager.refreshHome();
	    	});
	    },
	    error: function (e) {
	    	alert('Error uploading file');
	    	resetForm();
	    }
	});	
	
	$uploadBtn.click(function(event) {
		event.preventDefault();
		$file.click();
	});
	
	$file.change(function(event) {
		event.preventDefault();
		$form.submit();
	});
	
	
});
</script>
</div>


