<!-- ==== Html here === -->
<div class="page-section" id="step-edit-page">

	<!--  Header button bar  -->
<!-- 	<div class="row no-margin-no-padding header-button-group" > -->
<!-- 		<div class="col-md-2 col-md-offset-4 no-padding"> -->
<!-- 			<button class="btn blue-btn" name="show-edit-btn" >Edit</button> -->
<!-- 		</div> -->
<!-- 		<div class="col-md-2 no-padding"> -->
<!-- 			<button class="btn blue-btn" name="show-exec-btn">Test/Execute</button> -->
<!-- 		</div> -->
<!-- 		<div class="col-md-2"></div> -->
<!-- 	</div> -->
	
	<!-- edit form -->
	<div class="row width100" id="calculation-step-edit-container" >
	
		<form id="step-form" class="form-horizontal width100" method="POST" action="rest/calculationstep/save.json">
			<input type="hidden" class="form-control" name="id" /> 
			<input type="hidden" class="form-control" name="active" value="true" /> 
			<div class="row col-md-8 col-md-offset-2">
<!-- 				<fieldset class="width100"> -->
					<div class="form-group">
						<label class="col-md-2 control-label">Type</label>
						<div class="col-md-10" style="text-align: left">
							<input type="hidden" name="type">
							<button class="btn option-btn" name="type-r-script" style="min-width: 10em">R script</button>
							<button class="btn option-btn" name="type-equation" style="min-width: 10em">External equation</button>
							<button class="btn option-btn" name="type-category" style="min-width: 10em">Category</button>
						</div>
					</div>
					
					<div class="form-group">
						<label class="col-md-2 control-label">Caption</label>
						<div class="col-md-10">
							<input type="text" class="form-control" name="caption">
						</div>
					</div>
					<div class="form-group">
						<label class="col-md-2 control-label">Entity</label>
						<div class="col-md-10">
							<select class="form-control" name="entityId"></select>
						</div>
					</div>
					
					<div class="form-group output-variable-form">
						<label for="select-variable" class="col-md-2 control-label">Variable</label>
						<div class="col-md-9">
							<select class="form-control" name="variableId"></select>
						</div>
						<button name="add-variable" type="button" class="calculation btn btn-info col-md-1" disabled="disabled">
							<i class="icon-plus-sign-alt"></i>
						</button>
					</div>
					<!-- category form -->
					<div class="form-group output-category-form">
						<label for="categoryId" class="col-md-2 control-label">Category</label>
						<div class="col-md-9">
							<select class="form-control" name="categoryId"></select>
						</div>
						<button name="add-category" type="button" class="calculation btn btn-info col-md-1" >
							<i class="icon-plus-sign-alt"></i>
						</button>
					</div>
					
					<div class="form-group category-form">
						<div class="col-md-12 form-container category-settings-form">
						</div>
					</div>
					<!-- r script -->
					<div class="form-group r-script-form">
						<label class="col-md-2 control-label">Script</label>
<!-- 						<div class="col-md-10" style="height: 350px"> -->
<!-- 							<div class="row width100 no-padding no-margin"> -->
<!-- 								<textarea name="script" id="r-script-text-area" style="width: 100%; height: 100%;"></textarea> -->
<!-- 							</div> -->
<!-- 						</div> -->
						<div class="col-md-10" style="height: 350px">
<!-- 							<div class="row width100 no-padding no-margin"> -->
								<textarea name="script" id="r-script-text-area" style="width: 100%; height: 100%;"></textarea>
<!-- 							</div> -->
						</div>
					</div>
					<!-- equation form -->
					<div class="equation-form no-padding">
						<div class="form-group">
							<label class="col-md-2 control-label">Equation list</label>
							<div class="col-md-10">
								<select class="form-control" name="equationList"></select>
							</div>
						</div>
						<div class="form-group">
							<label class="col-md-2 control-label">Code variable</label>
							<div class="col-md-10">
								<select class="form-control" name="codeVariable"></select>
							</div>
						</div>
					</div>
					
					<div class="form-group aggregate-form no-padding">
						<div class="col-md-12 form-container">
							<div class="form-group">
								<label class="col-md-2 control-label">Aggregate function</label>
								<div class="col-md-10 aggregate-functions-form">
									<input type="hidden" name="aggregateParameters" value="aaaa">
									<blockquote>
										<small><i>Available only for those entities that won't be aggregated using the sampling design</i></small>
										<small><i>Sum will be applied by default if none of the functions is selected</i></small>
										<button class="btn option-btn" name="sum" value="sum">sum</button>
										<button class="btn option-btn" name="min" value="min">min</button>
										<button class="btn option-btn" name="max" value="max">max</button>
										<button class="btn option-btn" name="avg" value="avg">avg</button>
										<button class="btn option-btn" name="count" value="count">count</button>
										<button class="btn option-btn" name="distinct-count" value="distinct-count">distinct-count</button>
									</blockquote>
								</div>
							</div>
						</div>
					</div>
					
					<div class="form-group buttons" style="margin: 0px">
						<div class="col-md-4 col-md-offset-4" style="text-align: center;">
							<button type="submit" class="btn btn-action width70"><i class="fa fa-floppy-o"></i>&nbsp;Save</button>
						</div>
					</div>
				
			</div>
		</form>
	</div>
	
	<!-- add variable popup form -->
	<div class="modal fade" id="add-variable-modal">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-body">
					<form class="form-vertical" method="POST">
						<input type="hidden" class="form-control" name="entityId" />
						<input type="hidden" class="form-control" name="type" />  
						<fieldset>
							<div class="form-group" style="margin: 10px 4em 0px 4em">
								<label class="control-label">Name</label>
								<input type="text" class="form-control" name="name"></input>
							</div>
							<div class="row" style="margin-top: 25px">
								<div class="col-md-3 col-md-offset-3">
									<button type="button" class="btn btn-default save" style="width:100%">Save</button>
								</div>
								<div class="col-md-3">
									<button type="button" class="btn btn-default" data-dismiss="modal" aria-hidden="true" style="width:100%">Cancel</button>
								</div>
							</div>					
						</fieldset>
					</form>
				</div>
			</div><!-- /.modal-content -->
		</div><!-- /.modal-dialog -->
	</div><!-- /.modal -->
	
	
	<!-- add category modal form -->
	<div class="modal fade" id="add-category-form">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-body calculation">
					<form class="form-horizontal" method="POST">
<!-- 						<input type="hidden" class="form-control" name="entityId" />  -->
						<fieldset>
						
<!-- 							<div class="form-group"> -->
<!-- 								<label class="col-md-2 control-label">Name</label> -->
<!-- 								<div class="col-md-10"> -->
<!-- 									<input type="text" class="form-control" name="name"> -->
<!-- 								</div> -->
<!-- 							</div> -->
							<div class="form-group">
								<label class="col-md-2 control-label">Caption</label>
								<div class="col-md-10">
									<input type="text" class="form-control" name="caption">
								</div>
							</div>
							<div class="form-group">
								<label class="col-md-2 control-label">Classes</label>
								
								<div class="col-md-10">
									<div class="row no-margin">
										<div class="col-md-3">
											Code
										</div>
										<div class="col-md-7">
											Caption
										</div>
									</div>
									<div class="row no-margin category-classes">
									</div>
								</div>
							</div>
							
							<div class="row" style="margin-top: 25px">
								<div class="col-md-3 col-md-offset-3">
									<button type="button" class="btn btn-default save" style="width:100%">Save</button>
								</div>
								<div class="col-md-3">
									<button type="button" class="btn btn-default" data-dismiss="modal" aria-hidden="true" style="width:100%">Cancel</button>
								</div>
							</div>					
						</fieldset>
					</form>
				</div>
			</div><!-- /.modal-content -->
		</div><!-- /.modal-dialog -->
	</div><!-- /.modal -->
	
<script>
$(function() {
	// step edit page
	var stepEdit = $( "#step-edit-page" );
	
	// ui managers 
	var calculationStepEditManager = new CalculationStepEditManager( stepEdit.find("#calculation-step-edit-container") );	
// 	var calculationStepResultsManager = new CalculationStepResultsManager( stepEdit.find("#calculation-step-results-container") );
// 	var calculationStepExecManager = new CalculationStepExecManager( stepEdit.find("#calculation-step-exec-container") , calculationStepResultsManager );
	
// 	calculationStepExecManager.hide();
// 	calculationStepResultsManager.hide();
	
	// header buttons
// 	var showEditBtn = stepEdit.find("button[name=show-edit-btn]");
// 	var showExecBtn = stepEdit.find("button[name=show-exec-btn]");
	// show edit section
// 	showEditBtn.click(function(e){
// 		e.preventDefault();
		
// 		calculationStepExecManager.hide();
// 		calculationStepResultsManager.hide();
// 		calculationStepEditManager.show();
// 	});
	
	// 	Show exec section
// 	showExecBtn.click( function(e){
// 		e.preventDefault();
// 		if( calculationStepEditManager.currentCalculationStep ){
// 			// first save the calculation step if it has changed
// 			calculationStepEditManager.saveIfChanged( function(response) {
// 				var calculationStep = response;
// 				calculationStepEditManager.hide();
// 				calculationStepResultsManager.hide();
// 				calculationStepExecManager.show(calculationStep);
// 			});
// 		} else {
// 			UI.showError("You must create a calculation step before trying to execute it", true);
// 		}
// 	});
	
	
	
	
	
	
	
});
</script>
</div>
